# JavaScript 查缺补漏

## 1. JavaScript基础
### 1.1 JavaScript组成
![js组成](https://s2.loli.net/2023/05/06/b8ihmMYKTFWtEJX.jpg)

* ECMAScript

    ECMAScript是JavaScript的规格，JavaScript是ECMAScript的一种实现。在日常场合，这两个词是可以互换的。JavaScript的创造者Netscape公司，将JavaScript提交给国际标准化组织ECMA，希望这种语言能够成为国际标准，后来ECMA发布文件的第一版(ECMA-262)，规定了浏览器脚本语言的标准，并将这种语言称为ECMAScript.
* Web APIs:
  * DOM 操作HTML文档结构，比如对页面元素进行移动、大小、添加删除等操作
  * 操作浏览器，比如页面弹窗，检测窗口宽度、存储数据到浏览器等

### 1.2 JavaScript结束符
JavaScript结束符是英文分号，可写可不写。换行符（回车）会被识别成结束符 ,所以一个完整的语句，不要手动换行。因此在实际开发中有许多人主张书写 JavaScript 代码时省略结束符，但为了风格统一，要写结束符就每句都写，要么每句都不写。VUE等js库源码全都采用了无结束符的写法。

```js
<script>
    let name= prompt("what's your name?")
    alert(`Hi ${name}`)
</script>
```

**多个立即执行函数要用`;`隔开，要不然会报错**。
```js
(function(){console.log(123)})();
(function(){console.log(456)})()
```

### 1.3 let与var
js早起版本中声明变量多使用`var`关键字，新版本中都推荐使用`let`关键字声明变量，`const`关键字声明常量。

`let`关键字解决了`var`关键字存在的诸如如下的一些问题：
* 变量先使用后声明
* 变量重复声明
* 比如变量提升、全局变量、没有块级作用域等

ES6中变量必须先声明后使用，不存在变量名提升和函数名提升，只有函数声明会提升。

### 1.4 数据类型
![js数据类型](https://s2.loli.net/2023/05/06/x12pHbY4iNAsL3r.jpg)

基本数据类型是值传递，引用类型是地址传递。

* `undefined` 表示没有赋值,`null`表示赋值了，但是内容为空。
* `NaN`(Not a Number)表示非数字、`Infinity`则表示数字类型的无穷。`isNaN()`判断是否是非数字和`isFinite()`判断是否有穷尽


#### 1.4.1 相等运算符
相等运算符,在 js 中等于和不等于有两种形式:

运算符|作用
:-|:-
`=`和`!=`|只看结果是否相同(存在变量隐式转换的问题）
`===`和`!==`|看类型和结果是否都一致

**一般没有特殊需求时使用三个等号方式**。`undefined`和`null`变量用`==`相等，用`===`则不相等。`NaN`不等于任何值，包括它本身

#### 1.4.2 `in` 和 `instanceof`
在写类库的时候，或方法框架的时候经常需要判断一个变 量是什么类型的对象或判断这个对象是否具有某个成员， 此时可以使用 `in` 和 `instanceof` 运算符。

```js
//in运算符用于检查对象是否具有指定成员 
//语法:boolean 成员名符串 in 对象; 
var o = { name: "Colin", gender: "男", say: function () { } }
alert("say" in o)
alert("age" in o)
alert(!!o.age) //也可以转换为 boolean 判断是否具有此属性

//判断对象是否是某个类型的实例，类似C#中的is运算符 
//语法:boolean 对象 instanceof 构造函数;
var arr = [123, "abc", true]
alert(arr instanceof Array)
//instanceof运算符同样适用于自定义类型
var Person = function () { }//Person对象构造函数
var p = new Person()
alert(p instanceof Student)
```

## 1.5 包装对象
`number/string/bool`等基本数据类型都有对应的包装对象(wrapper)，包装对象不仅具有和基本类型一样的值， 还包含相关的方法与属性。 就如同 C#当中 int 与 Int32,string 与 String 的关系。包装类型与基本类型用法一致，但是基本类型的扩充

```js
let num=new Number(123)//使用 new 关键字创建包装类型

let num=10
num.toString() //num 在内存中临时创建一个 Number 对象，并执行 toString()方法， 将结果返回，同时释放这这个包装对象
```

* 所有包装类型的变量都是对象， 哪怕其中没有值，仍然是一个空对象， 其 typeof 的值是都是 Object，所有的非 null 的对象转布尔都是 true
* 工作机制(瞬时创建、瞬时调用、瞬时释放)

普通的 string,number,boolean 变量都是 值类型，包装对象则是引用类型。值类型与应用类型作为参数传递时使用差异的。在js中也有堆栈的概念。值类型直接存储在栈中，引用类型则在存储在堆中。参数传递时传递的是栈中存储的内容(将栈中存储的内容拷贝一份作为参数传递)，值类型直接将本身复制一份进行传递，所以在函数内容修改与变量本身没有任何关系。 

引用类型变量传递的则是变量存储在栈中的堆地址引用，所以所以在函数内部操作的与外部是同一个对象。在函数内部我们通过`对象名.属性名`的方式访问变量在堆中存储的内容，修改后外部也生效，但如果我们在函数内部直接给形参变量赋值的话，相当于把形参变量(指针)指向了新的地址，操作的不再是实参的地址，外部变量依然指向原来的堆地址，所以没有变化。

## 1.6 数组
js 中的数组类似于C#当中的数组/`ArrayList`/`HashTable`的超强综合体。

* 无需预先定制数组长度，会自动根据长度自动调整
* 在 js 中不存在多维数组也没有规定数组的类型，我们可以用数组作为数组的元素模拟多维数组。
* js 中数组中可以存放任意类型的元素，数组的下标也可以是任意的数据类型
* 数组使用非数字下标时，不仅可以使用索引方式访问数组成员，还可以直接以"数 组名.成员下标"的方式方法，在把数组当做`Dictionary`时，这种用法很常用
  ```js
  var dict = new Array();
  dict["人"] = "ren"
  alert(dict["人"])
  alert(dict.人)
  ```
* 在一定程度上数组和对象没有本质的区别。对象是一堆键值对的集合，对象的键不能是负数 (对象的键如果是自然数，对象属性只能通过索引方式访问，不能通过`对象名.属性名`的方式访问)，值可以是任意数据。数组也是一堆键值对的集合，数组的键可以是任意数据类型，值也可以是任意数据类型。对象通过字面值方式声明比较方便，数组通过字面值声明时，默认是数字索引的下标。如果把数组当做字典使用，必须通过`new Array`的方式声明。

* 在js中可以为数组的`length`随意的赋值，可以扩充数组或者移除数组元素没有赋值的元素默认为`undefined`
* `splice()` 方法用于插入、删除或替换数组的元素。如果有`element`参数则在删除的位置插入`element`元素，如果指定的删除长度为0，则变成单纯的数组插入操作。 使用`splice()`删除数组元素时会把数组的索引和值一同删除，数组长度跟随变化，推荐使用`splice()`方法替代`delete()`
  * 语法:`arrayObject.splice(index,howmany,element1,.....,elementX)`
  * `index`必需参数。规定从何处添加/删除元素。该参数是开始插入和（或）删除的数 组元素的下标，必须是数字。
  * `howmany`必需参数。规定应该删除多少元素。必须是数字，但可以是 "0"。如果未 规定此参数，则删除从`index`开始到原数组结尾的所有元素。
  * `elementX` 可选参数。规定要添加到数组的新元素。从`index`所指的下标处开始插入。
       
* `push()`用于压栈一个或多个元素，并返回数组新的长度。
* `unshift()`用于入队一个或多个元素，并返回数组新的长度。
* `pop()`用于出栈一个元素，如果数组已经为空，则返回`undefined`值。
* `shift()`用于出队一个元素,如果数组已经为空，则返回`undefined`值。

